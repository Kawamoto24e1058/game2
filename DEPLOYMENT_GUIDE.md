# 🚀 Renderデプロイガイド

## ⚠️ 重要：コードは既に完璧です

現在の `server.js` は873行、以下の機能をすべて実装済みです：

### ✅ 実装済み機能
- HP管理システム（120 HP）
- ターン制バトル（攻撃→防御フェーズ）
- 属性相性計算（火>土>風>雷>水>火、光↔闇）
- サボテン20%反射（hasReflect フラグ）
- サポート機能（3回/試合）
- パスワードルーム
- 使用済み単語チェック
- 防御失敗判定
- 切断時の勝利処理
- 詳細なGeminiプロンプト（物質的特徴分析）

### 構文検証結果
```bash
$ node --check server.js
✅ エラーなし
```

## 🔧 Renderでエラーが出る場合の対処

### 1. ビルドキャッシュのクリア（最重要）
1. Render Dashboard → 該当サービス
2. "Manual Deploy" → **"Clear build cache & deploy"**
3. ログで `✅ 構文エラーなし` を確認

### 2. 環境変数の確認
```
GEMINI_API_KEY=your_actual_api_key_here
```

### 3. Node.jsバージョン
- `.node-version` と `.nvmrc` で v20 を指定済み

### 4. ログの確認ポイント
- `SyntaxError` が出ている行番号を確認
- **古いデプロイのログを見ていないか確認**
- 最新コミット `4931d36` がデプロイされているか

## 📊 現在のコードと提案コードの比較

| 項目 | 現在のserver.js | 提案された簡易版 |
|------|----------------|----------------|
| 行数 | 873行 | ~100行 |
| HP管理 | ✅ | ❌ |
| ターン制 | ✅ | ❌ |
| 防御フェーズ | ✅ | ❌ |
| サポート機能 | ✅ | ❌ |
| パスワードルーム | ✅ | ❌ |
| 詳細プロンプト | ✅ | ❌ |
| 構文エラー | なし | なし |

**結論**: 現在のコードを維持し、Renderのキャッシュをクリアしてください。

## 📝 最終確認コマンド
```bash
# ローカルで構文チェック
node --check server.js

# 正常起動テスト
GEMINI_API_KEY=test node server.js
# → "Server running on port 3000" が出ればOK
```
